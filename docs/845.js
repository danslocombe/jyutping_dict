"use strict";(self.webpackChunkrust_webpack_template=self.webpackChunkrust_webpack_template||[]).push([[845],{300:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{tg:()=>c.tg});var o=n(650),c=n(408),i=e([o]);o=(i.then?(await i)():i)[0],(0,c.lI)(o),o.__wbindgen_start(),r()}catch(e){r(e)}}))},408:(e,t,n)=>{let r;function o(e){r=e}n.d(t,{EF:()=>w,M$:()=>b,N7:()=>g,Qn:()=>T,ZH:()=>y,bL:()=>E,lI:()=>o,tg:()=>p,yc:()=>C}),e=n.hmd(e);let c=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});c.decode();let i=null;function a(){return null!==i&&0!==i.byteLength||(i=new Uint8Array(r.memory.buffer)),i}function l(e,t){return e>>>=0,c.decode(a().subarray(e,e+t))}let d=0,s=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const u="function"==typeof s.encodeInto?function(e,t){return s.encodeInto(e,t)}:function(e,t){const n=s.encode(e);return t.set(n),{read:e.length,written:n.length}};function f(e,t,n){if(void 0===n){const n=s.encode(e),r=t(n.length,1)>>>0;return a().subarray(r,r+n.length).set(n),d=n.length,r}let r=e.length,o=t(r,1)>>>0;const c=a();let i=0;for(;i<r;i++){const t=e.charCodeAt(i);if(t>127)break;c[o+i]=t}if(i!==r){0!==i&&(e=e.slice(i)),o=n(o,r,r=i+3*e.length,1)>>>0;const t=a().subarray(o+i,o+r);i+=u(e,t).written,o=n(o,r,i,1)>>>0}return d=i,o}let h=null;function m(){return(null===h||!0===h.buffer.detached||void 0===h.buffer.detached&&h.buffer!==r.memory.buffer)&&(h=new DataView(r.memory.buffer)),h}const _="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_jyutpingsearch_free(e>>>0,1)));class p{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,_.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_jyutpingsearch_free(e,0)}constructor(e){const t=function(e,t){const n=t(1*e.length,1)>>>0;return a().set(e,n/1),d=e.length,n}(e,r.__wbindgen_malloc),n=d,o=r.jyutpingsearch_new(t,n);return this.__wbg_ptr=o>>>0,_.register(this,this.__wbg_ptr,this),this}search(e,t){let n,o;try{const c=f(e,r.__wbindgen_malloc,r.__wbindgen_realloc),i=d,a=r.jyutpingsearch_search(this.__wbg_ptr,c,i,t);return n=a[0],o=a[1],l(a[0],a[1])}finally{r.__wbindgen_free(n,o,1)}}}function g(e,t){let n,o;try{n=e,o=t,console.error(l(e,t))}finally{r.__wbindgen_free(n,o,1)}}function b(e){console.log(e)}function w(){return new Error}function y(e,t){const n=f(t.stack,r.__wbindgen_malloc,r.__wbindgen_realloc),o=d;m().setInt32(e+4,o,!0),m().setInt32(e+0,n,!0)}function E(){const e=r.__wbindgen_export_3,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}function C(e,t){return l(e,t)}function T(e,t){throw new Error(l(e,t))}},650:(e,t,n)=>{var r=n(408),o=n(708);e.exports=n.v(t,e.id,"263d969131a972a581ab",{"./index_bg.js":{__wbg_new_e1783397fe548703:r.EF,__wbg_stack_a86c1d26fea867df:r.ZH,__wbg_error_e4ae10165260c6e8:r.N7,__wbindgen_string_new:r.yc,__wbg_log_31ba0a55511144c4:r.M$,__wbindgen_throw:r.Qn,__wbindgen_init_externref_table:r.bL},"./snippets/rust-webpack-template-eb3e344350874cf2/inline1.js":{performance_now:o.G}})},708:(e,t,n)=>{function r(){return performance.now()}n.d(t,{G:()=>r})},845:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.r(t);var o=n(300),c=e([o]);o=(c.then?(await c)():c)[0];const m=window.location.search,_=new URLSearchParams(m);var i,a=_.get("q"),l=document.getElementById("entry"),d=document.getElementById("results"),s=document.getElementById("explanation"),u="1"===_.get("debug"),f="",h=12;function p(e){return"CEDict"===e?"ce-dict":"CCanto"===e?"cc-canto":""}function g(e){const t=JSON.parse(e),n=t.results;if(0!=n.length){var r=document.createElement("ul");if(r.setAttribute("class","card"),u){let e=document.createElement("div");e.setAttribute("class","debug-info");let n=document.createElement("pre");n.innerText=JSON.stringify(t.timings,null,2),e.appendChild(n),r.appendChild(e);const o=document.createElement("hr");r.appendChild(o)}for(let e of n){let t=document.createElement("li");t.setAttribute("class","card-item");let n=e.rendered_entry.entry_source,o=p(n),c=document.createElement("span");c.setAttribute("class","item-english");let i=document.createElement("h2");i.setAttribute("class","title"),i.innerHTML=w(e.rendered_entry.characters),c.appendChild(i);let a=document.createElement("span");a.setAttribute("class","item-jyutping");{let t=document.createElement("h3");t.setAttribute("class","title"),t.setAttribute("title",e.rendered_entry.entry_source),t.innerHTML=b(e.rendered_entry.jyutping),a.appendChild(t)}t.appendChild(a),t.appendChild(c),r.appendChild(t);for(let t=0;t<e.rendered_entry.english_definitions.length;t++){let n=e.rendered_entry.english_definitions[t],o=document.createElement("li");o.setAttribute("class","card-item");let c=document.createElement("span");c.setAttribute("class","item-english indent"),c.innerHTML=n,o.appendChild(c),r.appendChild(o)}let l=document.createElement("p");if(l.setAttribute("class","item-english "+o),"CEDict"===n?l.innerText="(Sourced from CEDict)":"CCanto"==n&&(l.innerText="(Sourced from CC-Canto)"),r.appendChild(l),u){let t=document.createElement("div");t.setAttribute("class","debug-info");let n=document.createElement("pre");n.innerText=JSON.stringify(e,null,2),t.appendChild(n),r.appendChild(t)}}if(d.appendChild(r),n.length===h){var o=document.createElement("button");o.setAttribute("class","load-more-btn"),o.innerText="More",o.onclick=()=>{h*=2,d.innerHTML="",i.search(f,h),g(f)},d.appendChild(o)}}}function b(e){const t=document.createElement("div");t.innerHTML=e;const n=document.createElement("div");return y(t,n),n.innerHTML}function w(e){const t=document.createElement("div");t.innerHTML=e;const n=document.createElement("div");return E(t,n),n.innerHTML}function y(e,t){let n=null,r="";function o(){n&&r.trim().length>0&&(n.href=`?q=${encodeURIComponent(r.trim())}`,t.appendChild(n),n=null,r="")}function c(e){if(e.nodeType===Node.TEXT_NODE){const c=e.textContent.split(/(\s+)/);for(let e of c)e.trim().length>0?(n||(n=document.createElement("a"),n.className="jyutping-link"),n.appendChild(document.createTextNode(e)),r+=e):e.length>0&&(o(),t.appendChild(document.createTextNode(e)))}else if(e.nodeType===Node.ELEMENT_NODE){n||(n=document.createElement("a"),n.className="jyutping-link");const t=document.createElement(e.tagName);for(let n of e.attributes)t.setAttribute(n.name,n.value);for(let n of e.childNodes)i(n,t);n.appendChild(t)}}function i(e,t){if(e.nodeType===Node.TEXT_NODE)t.appendChild(document.createTextNode(e.textContent)),r+=e.textContent;else if(e.nodeType===Node.ELEMENT_NODE){const n=document.createElement(e.tagName);for(let t of e.attributes)n.setAttribute(t.name,t.value);for(let t of e.childNodes)i(t,n);t.appendChild(n)}}for(let t of e.childNodes)c(t);o()}function E(e,t){function n(e){if(e.nodeType===Node.TEXT_NODE){const n=e.textContent;for(let e of n){const n=document.createElement("a");n.href=`?q=${encodeURIComponent(e)}`,n.className="character-link",n.textContent=e,t.appendChild(n)}}else if(e.nodeType===Node.ELEMENT_NODE){const n=document.createElement(e.tagName);for(let t of e.attributes)n.setAttribute(t.name,t.value);for(let t of e.childNodes)if(t.nodeType===Node.TEXT_NODE)for(let e of t.textContent){const t=document.createElement("a");t.href=`?q=${encodeURIComponent(e)}`,t.className="character-link",t.textContent=e,n.appendChild(t)}else r(t,n);t.appendChild(n)}}function r(e,t){if(e.nodeType===Node.TEXT_NODE)for(let n of e.textContent){const e=document.createElement("a");e.href=`?q=${encodeURIComponent(n)}`,e.className="character-link",e.textContent=n,t.appendChild(e)}else if(e.nodeType===Node.ELEMENT_NODE){const n=document.createElement(e.tagName);for(let t of e.attributes)n.setAttribute(t.name,t.value);for(let t of e.childNodes)r(t,n);t.appendChild(n)}}for(let t of e.childNodes)n(t)}async function C(e){try{const t=await N(),n=await x(t,e);if(n)return console.log("Using cached dictionary from IndexedDB"),n}catch(e){console.warn("IndexedDB access failed, falling back to network:",e)}console.log("Fetching dictionary from network");const t=await fetch(e,{cache:"force-cache"});if(!t.ok)throw new Error(`Failed to fetch dictionary blob: ${t.status} ${t.statusText}`);const n=await t.arrayBuffer();try{const t=await N();await v(t,e,n),console.log("Dictionary cached in IndexedDB")}catch(e){console.warn("Failed to cache dictionary in IndexedDB:",e)}return n}C("full.jyp_dict").then((e=>{console.log("Got dictionary blob",e.byteLength,"bytes");const t=new Uint8Array(e);i=new o.tg(t),console.log("Finished search init!"),l.removeAttribute("disabled"),l.setAttribute("placeholder","lou5 si1, teacher, 老師, ..."),l.focus();const n=e=>{if(d.innerHTML="",e.length>0){f!==e&&(f=e,h=12),g(i.search(e,h)),s.hidden=!0;const t=new URL(window.location);t.searchParams.set("q",e),window.history.replaceState({},"",t)}else{l.setAttribute("placeholder",""),s.hidden=!1,f="",h=12;const e=new URL(window.location);e.searchParams.delete("q"),window.history.replaceState({},"",e)}};l.addEventListener("input",(e=>n(e.target.value))),a&&(n(a),l.value=a)}));const T="jyut";function N(){return new Promise(((e,t)=>{const n=indexedDB.open("jyutping_dict_cache",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(T)||t.createObjectStore(T)}}))}function x(e,t){return new Promise(((n,r)=>{const o=e.transaction([T],"readonly").objectStore(T).get(t);o.onerror=()=>r(o.error),o.onsuccess=()=>n(o.result)}))}function v(e,t,n){return new Promise(((r,o)=>{const c=e.transaction([T],"readwrite").objectStore(T).put(n,t);c.onerror=()=>o(c.error),c.onsuccess=()=>r()}))}r()}catch(A){r(A)}}))}}]);